<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Balança ESP32</title>
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <script src="mqtt.js"></script>
</head>
<body class="bg-light">
  <div class="container text-center mt-5">
    <h1 class="mb-3">Shark - Balança Smart</h1>
    <div class="card shadow p-4">
      <h1 class="mb-3">Peso da Balança</h1>
      <h2 id="peso" class="text-primary">Conectando...</h2>
    </div>
  </div>

  <script>
    // Conectar ao broker HiveMQ via WebSocket
    const client = mqtt.connect('ws://test.mosquitto.org:8080/mqtt');

    client.on('connect', function () {
      console.log("Conectado ao broker MQTT!");
      client.subscribe('shark/balanca/peso');
    });

    client.on('message', function (topic, message) {
      const peso = message.toString();
      console.log("Peso recebido:", peso);
      document.getElementById('peso').innerText = peso;
    });

    client.on('error', function (err) {
      console.error("Erro MQTT:", err);
      document.getElementById('peso').innerText = "Erro de conexão MQTT";
    });
  </script>
</body>
</html>